<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
    <!-- Mobile Specific Meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Favicon-->
    <link rel="shortcut icon" href="img/fav.png">
    <!-- Author Meta -->
    <meta name="author" content="codepixer">
    <!-- Meta Description -->
    <meta name="description" content="">
    <!-- Meta Keyword -->
    <meta name="keywords" content="">
    <!-- meta character set -->
    <meta charset="UTF-8">
    <!-- Site Title -->
    <title>Smuuth Events</title>

    <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="css/linearicons.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
        /* Tabs Styling */
        .events-tabs-container {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .events-tabs {
            display: flex;
            border-bottom: 2px solid #f9f9ff;
            margin-bottom: 20px;
            gap: 10px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            background: #f9f9ff;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            font-size: 14px;
            color: #222222;
            transition: all 0.3s ease;
            position: relative;
            outline: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }

        .tab-btn:focus {
            outline: none;
        }

        .tab-btn:hover {
            background: #e8e8ff;
            color: #49e4fa;
        }

        .tab-btn.active {
            background: #49e4fa;
            color: #fff;
            box-shadow: 0 2px 8px rgba(73, 228, 250, 0.3);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #49e4fa;
        }

        /* Events List Container */
        #event-list {
            max-height: 700px;
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 10px;
        }

        /* Custom Scrollbar */
        #event-list::-webkit-scrollbar {
            width: 8px;
        }

        #event-list::-webkit-scrollbar-track {
            background: #f9f9ff;
            border-radius: 10px;
        }

        #event-list::-webkit-scrollbar-thumb {
            background: #49e4fa;
            border-radius: 10px;
        }

        #event-list::-webkit-scrollbar-thumb:hover {
            background: #38d3e8;
        }

        /* Event Card Enhancement */
        .single-post.job-listing {
            background: #fff;
            border: 1px solid #f0f0f0;
            border-radius: 8px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .single-post.job-listing:hover {
            box-shadow: 0 4px 15px rgba(73, 228, 250, 0.2);
            transform: translateY(-2px);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #777777;
        }

        .empty-state i {
            font-size: 64px;
            color: #e0e0e0;
            margin-bottom: 20px;
        }

        .empty-state h4 {
            color: #222222;
            margin-bottom: 10px;
        }

        .empty-state p {
            color: #777777;
        }

        /* Custom Alert Modal */
        .custom-alert-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .custom-alert-overlay.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .custom-alert-box {
            background: #fff;
            border-radius: 15px;
            padding: 30px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease;
            text-align: center;
        }

        .custom-alert-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .custom-alert-icon.success {
            color: #4CAF50;
        }

        .custom-alert-icon.error {
            color: #f44336;
        }

        .custom-alert-icon.warning {
            color: #ff9800;
        }

        .custom-alert-icon.info {
            color: #49e4fa;
        }

        .custom-alert-title {
            font-family: 'Poppins', sans-serif;
            font-size: 24px;
            font-weight: 600;
            color: #222222;
            margin-bottom: 15px;
        }

        .custom-alert-message {
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            color: #777777;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .custom-alert-btn {
            background: #49e4fa;
            color: #fff;
            border: none;
            border-radius: 25px;
            padding: 12px 40px;
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
        }

        .custom-alert-btn:hover {
            background: #38d3e8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(73, 228, 250, 0.4);
        }

        .custom-alert-btn:active {
            transform: translateY(0);
        }

        .custom-alert-btn-group {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .custom-alert-btn.secondary {
            background: #f9f9ff;
            color: #222222;
        }

        .custom-alert-btn.secondary:hover {
            background: #e8e8ff;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <!-- Custom Alert Modal -->
    <div class="custom-alert-overlay" id="customAlertOverlay">
        <div class="custom-alert-box">
            <div class="custom-alert-icon" id="customAlertIcon">
                <i class="fa fa-info-circle"></i>
            </div>
            <h3 class="custom-alert-title" id="customAlertTitle">Alert</h3>
            <p class="custom-alert-message" id="customAlertMessage"></p>
            <div class="custom-alert-btn-group" id="customAlertButtons">
                <button class="custom-alert-btn" id="customAlertOkBtn">OK</button>
            </div>
        </div>
    </div>

    <header id="header" id="home">
        <div class="container">
            <div class="row align-items-center justify-content-between d-flex">
                <div id="logo">
                    <a href="index.html"><img src="img/SMUUTH_words_pastel_ultraclean.png" alt="SMUUTH"
                            style="height:48px;width:auto;display:block"></a>
                </div>
                <nav id="nav-menu-container">
                    <ul class="nav-menu">
                        <li class="menu-active"><a href="index.html">Home</a></li>
                        <li><a href="about-us.html">About Us</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="calendar.html">Calendar</a></li>
                        <li><a href="points.html">Points</a></li>
                        <li><a class="ticker-btn" href="../review/event_feedback.html">Feedback Form</a></li>
                        <li>
                            <a href="../loginPage_file/ViewProfile.html" class="profile-icon-btn" aria-label="Profile">
                                <i class="fa fa-user"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- start banner Area -->
    <section class="banner-area relative" id="home">
        <div class="overlay overlay-bg"></div>
        <div class="container">
            <div class="row d-flex align-items-center justify-content-center">
                <div class="about-content col-lg-12">

                    <!-- <p class="text-white link-nav"><a href="index.html">Home </a> <span
                            class="lnr lnr-arrow-right"></span> <a href="events.html">Events</a></p> -->
                    <div class="container">
                        <h1 class="text-white" style="margin-bottom: 100px;">Events</h1>
                        <div class="row d-flex align-items-center justify-content-center">
                            <div class="banner-content col-lg-12" style="margin-bottom: 0px;">
                                <form action="events.html" method="get" class="serach-form-area">
                                    <div class="row justify-content-center form-wrap">
                                        <div class="col-lg-4 form-cols">
                                            <input type="text" class="form-control" name="keywords"
                                                placeholder="What events do you want to help out in?">
                                        </div>
                                        <!-- <div class="col-lg-3 form-cols">
										<div class="default-select" id="default-selects">
											<select>
												<option value="1">Select area</option>
												<option value="2">Dhaka</option>
												<option value="3">Rajshahi</option>
												<option value="4">Barishal</option>
												<option value="5">Noakhali</option>
											</select>
										</div>
									</div> -->
                                        <div class="col-lg-4 form-cols">
                                            <div class="default-select" id="default-selects">
                                                <select name="category">
                                                    <option value="all">All Categories</option>
                                                    <option value="sports">Sports</option>
                                                    <option value="clubs">Clubs</option>
                                                    <option value="performing-arts">Performing Arts</option>
                                                    <option value="community-service">Community Service Projects
                                                    </option>
                                                    <option value="others">Others</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 form-cols">
                                            <button type="submit" class="btn btn-info">
                                                <span class="lnr lnr-magnifier"></span> Search
                                            </button>
                                        </div>
                                    </div>
                                </form>
                                <!-- <p class="text-white"> <span>Search by tags:</span> Tecnology, Business, Consulting, IT Company, Design, Development</p> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- End banner Area -->

    <!-- Start post Area -->

    <section class="post-area section-gap">
        <div class="container">
            <div class="row justify-content-center d-flex">
                <div class="col-lg-8 post-list ">
                    <!-- Tabs Navigation -->
                    <div class="events-tabs-container">
                        <div class="events-tabs">
                            <button class="tab-btn active" data-tab="all-events">
                                <i class="fa fa-th-list"></i> All Events
                            </button>
                            <button class="tab-btn" data-tab="my-events">
                                <i class="fa fa-star"></i> My Events
                            </button>
                            <button class="tab-btn" data-tab="joined-events">
                                <i class="fa fa-check-circle"></i> Joined Events
                            </button>
                        </div>
                        <!-- Events List -->
                        <div id="event-list">
                            <!-- <div class="single-post job-listing d-flex flex-row" data-category="clubs">
                        <div class="thumb">
                            <img src="img/post.png" alt="">

                        </div>
                        <div class="post-content d-flex flex-column">
                            <div class="details">
                                <div class="title">
                                    <a href="#">
                                        <h4>Registration Crew</h4>
                                    </a>
                                    <h6>ASMU</h6>
                                </div>
                                <p>
                                    Support general event logistics such as setting up booths, managing crowds, and
                                    assisting committees with on-site tasks.
                                </p>
                                <h5>Job Nature: Full Event</h5>
                                <p class="address"><span class="lnr lnr-map"></span> VIVACE</p>
                                <p class="address"><span class="lnr lnr-database"></span> 10 points</p>
                            </div>

                            <div class="job-meta">
                                <h4>Whom we are looking for</h4>
                                <p>Responsible, punctual individuals who can adapt to different tasks quickly.</p>
                            </div>

                            <div class="job-meta">
                                <h4>Experience Requirements</h4>
                                <ul>
                                    <li>
                                        <img src="img/pages/list.jpg" alt="">
                                        <span>No prior experience required — ideal for first-time volunteers.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>


                    </div>

                    <div class="single-post job-listing d-flex flex-row" data-category="clubs">
                        <div class="thumb">
                            <img src="img/post.png" alt="">

                        </div>
                        <div class="post-content d-flex flex-column">
                            <div class="details">
                                <div class="title">
                                    <a href="#">
                                        <h4>Booth Attendant</h4>
                                    </a>
                                    <h6>SMUB</h6>
                                </div>
                                <p>
                                    Manage event or sponsor booths, distribute materials, and answer basic enquiries.
                                </p>
                                <h5>Job Nature: Full Event</h5>
                                <p class="address"><span class="lnr lnr-map"></span> VIVACE</p>
                                <p class="address"><span class="lnr lnr-database"></span> 10 points</p>
                            </div>

                            <div class="job-meta">
                                <h4>Whom we are looking for</h4>
                                <p>Outgoing and approachable helpers who enjoy interacting with people.</p>
                            </div>

                            <div class="job-meta">
                                <h4>Experience Requirements</h4>
                                <ul>
                                    <li>
                                        <img src="img/pages/list.jpg" alt="">
                                        <span>Prior customer service or public engagement experience is an
                                            advantage.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="single-post job-listing d-flex flex-row" data-category="performing-arts">
                        <div class="thumb">
                            <img src="img/post.png" alt="">

                        </div>
                        <div class="post-content d-flex flex-column">
                            <div class="details">
                                <div class="title">
                                    <a href="#">
                                        <h4>Stage Crew</h4>
                                    </a>
                                    <h6>SMUB</h6>
                                </div>
                                <p>
                                    Assist with stage setup, cue management, and transitions between performances.
                                </p>
                                <h5>Job Nature: Full Event</h5>
                                <p class="address"><span class="lnr lnr-map"></span> VIVACE</p>
                                <p class="address"><span class="lnr lnr-database"></span> 10 points</p>
                            </div>

                            <div class="job-meta">
                                <h4>Whom we are looking for</h4>
                                <p>Calm and focused students who can follow instructions under pressure.</p>
                            </div>

                            <div class="job-meta">
                                <h4>Experience Requirements</h4>
                                <ul>
                                    <li>
                                        <img src="img/pages/list.jpg" alt="">
                                        <span>Preferably has experience with stage, theatre, or AV setups.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div> -->
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 sidebar">
                    <div class="single-slidebar">
                        <h3>Create an event!</h3>
                        <br>
                        <a class="ticker-btn" href="../eventCreation/eventCreate.html">Create Event</a>
                        <div class="eventImg">
                            <img class="img-fluid" src="img/eventCreate.jpg" alt="eventPhoto.jpg">
                        </div>
                        <!-- <div class="active-relatedjob-carusel">
								<div class="single-rated">
									<img class="img-fluid" src="img/r1.jpg" alt="">
									<a href="single.html"><h4>Creative Art Designer</h4></a>
									<h6>Premium Labels Limited</h6>
									<p>
										Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod temporinc ididunt ut dolore magna aliqua.
									</p>
									<h5>Job Nature: Full time</h5>
									<p class="address"><span class="lnr lnr-map"></span> 56/8, Panthapath Dhanmondi Dhaka</p>
									<p class="address"><span class="lnr lnr-database"></span> 15k - 25k</p>
									<a href="#" class="btns text-uppercase">Apply job</a>
								</div> -->
                        <!-- <div class="single-rated">
									<img class="img-fluid" src="img/r1.jpg" alt="">
									<a href="single.html"><h4>Creative Art Designer</h4></a>
									<h6>Premium Labels Limited</h6>
									<p>
										Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod temporinc ididunt ut dolore magna aliqua.
									</p>
									<h5>Job Nature: Full time</h5>
									<p class="address"><span class="lnr lnr-map"></span> 56/8, Panthapath Dhanmondi Dhaka</p>
									<p class="address"><span class="lnr lnr-database"></span> 15k - 25k</p>
									<a href="#" class="btns text-uppercase">Apply job</a>
								</div> -->
                        <!-- <div class="single-rated">
									<img class="img-fluid" src="img/r1.jpg" alt="">
									<a href="single.html"><h4>Creative Art Designer</h4></a>
									<h6>Premium Labels Limited</h6>
									<p>
										Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod temporinc ididunt ut dolore magna aliqua.
									</p>
									<h5>Job Nature: Full time</h5>
									<p class="address"><span class="lnr lnr-map"></span> 56/8, Panthapath Dhanmondi Dhaka</p>
									<p class="address"><span class="lnr lnr-database"></span> 15k - 25k</p>
									<a href="#" class="btns text-uppercase">Apply job</a>
								</div>																		 -->
                    </div>


                    <div class="single-slidebar">
                        <h4>Top rated reviews for events</h4>
                        <div id="topRatedEvents" class="active-relatedjob-carusel">
                            <!-- <h4>Events by Category</h4>
                        <ul class="cat-list">
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Technology</p><span>37</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Media & News</p><span>57</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Government</p><span>33</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Medical</p><span>36</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Restaurants</p><span>47</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Developer</p><span>27</span>
                                </a></li>
                            <li><a class="justify-content-between d-flex" href="category.html">
                                    <p>Accounting</p><span>17</span>
                                </a></li>
                        </ul> -->
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </section>
    <!-- End post Area -->

    <!-- Start callto-action Area -->
    <section class="submit-area section-gap" style="background-color:whitesmoke;">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-sm-9 mb-2 mx-auto">
                    <div class="submit-left">
                        <h4>Find Helpers</h4>
                        <p>
                            Post your needs and get verified helpers in minutes.
                        </p>
                        <a href="../eventCreation/eventCreate.html" class="primary-btn header-btn">Post a Job</a>
                    </div>
                </div>
                <div class="col-lg-6 col-sm-9 mb-2 mx-auto">
                    <div class="submit-right">
                        <h4>Find Events</h4>
                        <p>
                            Explore what’s happening around campus today.
                        </p>
                        <a href="../homePage/events.html" class="primary-btn header-btn">Find Events</a>
                    </div>
                </div>

            </div>
        </div>
    </section>
    <!-- End callto-action Area -->

    <!-- start footer Area -->
    <footer class="footer-area section-gap">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-12">
                    <div class="single-footer-widget newsletter">
                        <h6>Newsletter</h6>
                        <p>You can trust us. We only send promo offers, not a single spam.</p>

                        <form id="newsletter-form">
                            <div class="form-group row" style="width: 100%">
                                <div class="col-lg-8 col-md-12">
                                    <input name="to_email" placeholder="Enter Email" onfocus="this.placeholder=''"
                                        onblur="this.placeholder='Enter Email'" required type="email" />
                                </div>

                                <div class="col-lg-4 col-md-12">
                                    <button type="submit" class="nw-btn primary-btn">
                                        Subscribe<span class="lnr lnr-arrow-right"></span>
                                    </button>
                                </div>
                            </div>

                            <div class="info" id="newsletter-response"></div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="row footer-bottom d-flex justify-content-between">
                <p class="col-lg-8 col-sm-12 footer-text m-0 text-white">
                    Copyright &copy;
                    <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is
                    made with <i class="fa fa-heart-o" aria-hidden="true"></i> by
                    <a href="https://colorlib.com" target="_blank">Colorlib</a>
                </p>
                <div class="col-lg-4 col-sm-6 footer-social">
					<a href="https://www.facebook.com/people/SMUuth-Events/61583632431022/"><img
							src="img/facebook logo.svg" alt="facebook logo" class="socialLogo"></a>
					<a href="https://www.tiktok.com/en/"><img src="img/tiktok logo.png.svg" alt="tiktok logo" class="socialLogo"></a>
					<a href="https://www.instagram.com/smuuthevents?igsh=ZTJ2OWs2MHB2OW94&utm_source=qr">
						<img src="img/instagram logo.svg" alt="instagram logo" class="socialLogo">
					</a>
				</div>
            </div>
        </div>
    </footer>

    <!-- EmailJS v4 (load once, below your other scripts) -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

    <!-- FIXED Newsletter Form Script (Saves to Firestore + Sends Email) -->

    <!-- End footer Area -->

    <script src="js/vendor/jquery-2.2.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="js/easing.min.js"></script>
    <script src="js/hoverIntent.js"></script>
    <script src="js/superfish.min.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.sticky.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/parallax.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="js/main.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, serverTimestamp, doc, getDoc, updateDoc, query, where, deleteDoc, orderBy, limit } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import { checkLogin } from "../loginPage_file/authenticate.js";

        checkLogin()


        const firebaseConfig = {
            apiKey: "AIzaSyByPrDz810_ttwZz0BdAJkeP54rMIqH3uw",
            authDomain: "wad2-505be.firebaseapp.com",
            databaseURL: "https://wad2-505be-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "wad2-505be",
            storageBucket: "wad2-505be.firebasestorage.app",
            messagingSenderId: "221863917439",
            appId: "1:221863917439:web:2a517ca11c83e991388c4a",
            measurementId: "G-L69GG585GF"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const eventList = document.getElementById("event-list");
        let currentUser = null;
        let tabsInitialized = false;

        // Custom Alert System
        function showCustomAlert(message, type = 'info', title = null) {
            return new Promise((resolve) => {
                const overlay = document.getElementById('customAlertOverlay');
                const icon = document.getElementById('customAlertIcon');
                const titleEl = document.getElementById('customAlertTitle');
                const messageEl = document.getElementById('customAlertMessage');
                const okBtn = document.getElementById('customAlertOkBtn');

                // Set icon based on type
                const icons = {
                    success: '<i class="fa fa-check-circle"></i>',
                    error: '<i class="fa fa-times-circle"></i>',
                    warning: '<i class="fa fa-exclamation-triangle"></i>',
                    info: '<i class="fa fa-info-circle"></i>'
                };

                icon.innerHTML = icons[type] || icons.info;
                icon.className = `custom-alert-icon ${type}`;

                // Set title
                const titles = {
                    success: 'Success!',
                    error: 'Error',
                    warning: 'Warning',
                    info: 'Information'
                };
                titleEl.textContent = title || titles[type] || 'Alert';

                // Set message
                messageEl.textContent = message;

                // Show overlay
                overlay.classList.add('show');

                // Handle OK button
                const handleOk = () => {
                    overlay.classList.remove('show');
                    okBtn.removeEventListener('click', handleOk);
                    overlay.removeEventListener('click', handleOverlayClick);
                    resolve(true);
                };

                // Handle clicking outside
                const handleOverlayClick = (e) => {
                    if (e.target === overlay) {
                        handleOk();
                    }
                };

                okBtn.addEventListener('click', handleOk);
                overlay.addEventListener('click', handleOverlayClick);
            });
        }

        function showCustomConfirm(message, title = 'Confirm') {
            return new Promise((resolve) => {
                const overlay = document.getElementById('customAlertOverlay');
                const icon = document.getElementById('customAlertIcon');
                const titleEl = document.getElementById('customAlertTitle');
                const messageEl = document.getElementById('customAlertMessage');
                const buttonsContainer = document.getElementById('customAlertButtons');

                // Set icon for confirmation
                icon.innerHTML = '<i class="fa fa-question-circle"></i>';
                icon.className = 'custom-alert-icon warning';

                // Set title and message
                titleEl.textContent = title;
                messageEl.textContent = message;

                // Create Yes/No buttons
                buttonsContainer.innerHTML = `
                    <button class="custom-alert-btn secondary" id="customAlertNoBtn">Cancel</button>
                    <button class="custom-alert-btn" id="customAlertYesBtn">Confirm</button>
                `;

                // Show overlay
                overlay.classList.add('show');

                const yesBtn = document.getElementById('customAlertYesBtn');
                const noBtn = document.getElementById('customAlertNoBtn');

                const handleYes = () => {
                    overlay.classList.remove('show');
                    cleanup();
                    resolve(true);
                };

                const handleNo = () => {
                    overlay.classList.remove('show');
                    cleanup();
                    resolve(false);
                };

                const cleanup = () => {
                    yesBtn.removeEventListener('click', handleYes);
                    noBtn.removeEventListener('click', handleNo);
                    overlay.removeEventListener('click', handleOverlayClick);
                    // Reset to single OK button
                    buttonsContainer.innerHTML = '<button class="custom-alert-btn" id="customAlertOkBtn">OK</button>';
                };

                const handleOverlayClick = (e) => {
                    if (e.target === overlay) {
                        handleNo();
                    }
                };

                yesBtn.addEventListener('click', handleYes);
                noBtn.addEventListener('click', handleNo);
                overlay.addEventListener('click', handleOverlayClick);
            });
        }

        //if profileID not initialized, initialize
        if (localStorage.getItem("profileID") == null) {
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    const profilesRef = collection(db, "profiles");
                    const q = query(profilesRef, where("userId", "==", user.uid));
                    const querySnapshot = await getDocs(q);
                    querySnapshot.forEach((doc) => {
                        let profileID = doc.id;
                        localStorage.setItem("profileID", profileID);
                    });
                }
            });
        }


        function normaliseCategory(v) {
            const normalized = (v || '').toString().trim().toLowerCase().replace(/\s+/g, '-');

            return normalized;
        }

        function slug(v) { return (v ?? '').toString().trim().toLowerCase().replace(/\s+/g, '-'); }

        // canonical: map URL/legacy variants to your canonical slugs
        function canonical(v) {
            const s = slug(v);
            const map = {
                'all-categories': 'all',                 // from index.html
                'community-service-projects': 'community-service', // from index.html
                // add other synonyms here if your UI ever sends them
            };
            return map[s] || s;
        }

        function applyCategoryFilter(category) {
            const wanted = slug(category || 'all');
            let shown = 0;

            const allCards = document.querySelectorAll('.single-post.job-listing');

            allCards.forEach(card => {
                const cat = slug(card.getAttribute('data-category') || 'others'); // ← canonicalize here
                const match = (wanted === 'all') || (cat === wanted);
                card.classList.toggle('d-none', !match)
                card.classList.toggle('d-flex', match)
                if (match) shown++;
            });

            // optional empty-state
            let empty = document.getElementById('no-results');
            if (!shown) {
                if (!empty) {
                    empty = document.createElement('div');
                    empty.id = 'no-results';
                    empty.style.color = 'red';
                    empty.style.margin = '16px 0';
                    empty.textContent = 'No events match this category.';
                    document.getElementById('event-list').appendChild(empty);
                }
            } else if (empty) {
                empty.remove();
            }
        }

        function applyKeywordFilter(keywords) {
            const q = (keywords || '').trim().toLowerCase();
            const terms = q.split(/\s+/).filter(Boolean); // multi-word support
            let shown = 0;

            const allCards = document.querySelectorAll('.single-post.job-listing');

            allCards.forEach(card => {
                const name = (card.querySelector('.title h4')?.textContent || '').toLowerCase();
                const desc = (card.querySelector('.details p:nth-of-type(2)')?.textContent || '').toLowerCase();
                const haystack = `${name} ${desc}`;

                const match = terms.length === 0 ? true : terms.every(t => haystack.includes(t));

                card.classList.toggle('d-none', !match);
                card.classList.toggle('d-flex', match);
                if (match) shown++;
            });

            // optional empty-state (reuses same element id as your category filter)
            let empty = document.getElementById('no-results');
            if (!shown) {
                if (!empty) {
                    empty = document.createElement('div');
                    empty.id = 'no-results';
                    empty.style.color = 'red';
                    empty.style.margin = '16px 0';
                    empty.textContent = 'No events match these keywords.';
                    document.getElementById('event-list').appendChild(empty);
                } else {
                    empty.textContent = 'No events match these keywords.';
                }
            } else if (empty) {
                empty.remove();
            }
        }
        function applyKeywordFilterFromURL() {
            const params = new URLSearchParams(location.search);
            const q = params.get('keywords') || '';
            applyKeywordFilter(q);
        }

        function showAll() {
            document.querySelectorAll('.single-post.job-listing').forEach(card => {
                card.classList.remove('d-none');
                card.classList.add('d-flex');
            });
            const empty = document.getElementById('no-results');
            if (empty) empty.remove();
        }

        // prefer keywords over category
        function applyFiltersFromURL() {
            const params = new URLSearchParams(location.search);
            const q = (params.get('keywords') || '').trim();
            const cat = params.get('category') || 'all';
            if (q) {
                showAll();              // don’t let category hide matches
                applyKeywordFilter(q);  // search by name/description only
            } else {
                applyCategoryFilter(cat);
            }
        }

        function applyCategoryFilterFromURL() {
            const params = new URLSearchParams(window.location.search);
            const selected = params.get('category') || 'all';
            console.log(`URL category parameter: "${selected}"`);
            applyCategoryFilter(selected);
        }



        async function loadEvents() {
            eventList.innerHTML = ""; // clear static content
            const snapshot = await getDocs(collection(db, "events"));
            if (snapshot.empty) {
                eventList.innerHTML = `<p class="text-center">No events available yet.</p>`;
                return;
            }

            snapshot.forEach(docSnap => {
                const event = docSnap.data();
                const eventId = docSnap.id;

                const dataCat = slug(event.category || 'others');
                const dataName = (event.name || '').toLowerCase()
                const dataDesc = (event.description || '').toLowerCase()

                console.log(`Processing event: ${event.name}, Category: ${event.category}`);

                let adminControls = "";
                let joinButton = "";

                if (currentUser) {
                    const isCreator = event.creatorId === currentUser.uid;
                    const isAdmin = currentUser.uid === "YOUR_SYSTEM_ADMIN_UID";
                    const profileID = localStorage.getItem('profileID');
                    const hasJoined = event.helpers && event.helpers.includes(profileID);

                    if (isCreator || isAdmin) {
                        adminControls = `
                        <div class="mt-2">
                            <button class="btn btn-sm btn-warning me-1" onclick="editEvent('${eventId}')">Edit</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteEvent('${eventId}', '${event.name}')">Delete</button>
                            <button class="btn btn-sm btn-success" onclick="viewapplicants('${eventId}', '${event.name}')">View Applicants</button>
                            <button class="btn btn-sm" onclick="endEvent('${eventId}', '${event.name}')">End Event</button>
                        </div>`;
                        // End event method is tentative
                    }

                    if (!isCreator) {
                        if (hasJoined) {
                            joinButton = `<button class="btn btn-danger mt-2" onclick="leaveEvent('${eventId}', '${event.name}')">Leave Event</button>`;
                        } else {
                            joinButton = `<button class="btn btn-primary mt-2" onclick="joinEvent('${eventId}', '${event.name}', ${event.rewardPoints})">Join Event</button>`;
                        }
                    }
                } else {
                    joinButton = `<p class="text-muted mt-2">Log in to join this event</p>`;
                }

                const eventHTML = `
                <div class="single-post job-listing d-flex flex-row mb-3"
                     data-category="${canonical(dataCat || 'Others')}"
                     data-name="${dataName}"
                     data-desc="${dataDesc}"
                     data-creator-id="${event.creatorId || ''}"
                     data-event-id="${eventId}"
                     data-helpers='${JSON.stringify(event.helpers || [])}'>
                    <div class="thumb"><img class="img-fluid" src="img/SMUUTH_words_pastel_ultraclean.png"
								style="height:48px;width:auto;display:block" alt="logo.png"></div>  
                    <div class="post-content d-flex flex-column w-100">
                        <div class="details px-4">
                            <div class="title"><a href="#"><h4>${event.name}</h4></a><h6>${event.location}</h6></div>
                            <p><strong>Category:</strong> ${event.category || 'Others'}</p>
                            <p>${event.description || "No description provided."}</p>
                            <h5>Manpower Needed: ${event.manpower}</h5>
                            <p class="address"><span class="lnr lnr-map"></span> ${event.location}</p>
                            <p class="address"><span class="lnr lnr-database"></span> ${event.rewardPoints} points</p>
                            ${joinButton}
                            ${adminControls}
                        </div>
                    </div>
                </div>`;
                eventList.insertAdjacentHTML("beforeend", eventHTML);
            });
            applyFiltersFromURL();

            // Initialize tab listeners after events are loaded (only once)
            if (!tabsInitialized) {
                initializeTabs();
                tabsInitialized = true;
            }
        }

        // Tab filtering functions
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            console.log('Initializing tabs, found:', tabButtons.length);

            tabButtons.forEach(button => {
                button.addEventListener('click', function (e) {
                    e.preventDefault();
                    console.log('Tab clicked:', this.getAttribute('data-tab'));

                    // Remove active class from all buttons
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');

                    // Get the tab type
                    const tabType = this.getAttribute('data-tab');

                    // Apply the appropriate filter
                    filterEventsByTab(tabType);
                });
            });
        }

        function filterEventsByTab(tabType) {
            console.log('Filtering by tab:', tabType);
            console.log('Current user:', currentUser);
            console.log('Profile ID:', localStorage.getItem('profileID'));

            const allCards = document.querySelectorAll('.single-post.job-listing');
            const profileID = localStorage.getItem('profileID');
            let shown = 0;

            console.log('Total cards found:', allCards.length);

            allCards.forEach(card => {
                let shouldShow = false;

                if (tabType === 'all-events') {
                    // Show all events
                    shouldShow = true;
                } else if (tabType === 'my-events') {
                    // Show only events created by the user
                    const creatorId = card.getAttribute('data-creator-id');
                    console.log('Checking my-events:', { creatorId, currentUserUid: currentUser?.uid });
                    shouldShow = currentUser && creatorId === currentUser.uid;
                } else if (tabType === 'joined-events') {
                    // Show only events the user has joined
                    const helpersStr = card.getAttribute('data-helpers');
                    console.log('Helpers string:', helpersStr);
                    try {
                        const helpers = JSON.parse(helpersStr);
                        console.log('Parsed helpers:', helpers, 'ProfileID:', profileID);
                        shouldShow = profileID && helpers.includes(profileID);
                    } catch (e) {
                        console.error('Error parsing helpers:', e);
                        shouldShow = false;
                    }
                }

                card.classList.toggle('d-none', !shouldShow);
                card.classList.toggle('d-flex', shouldShow);
                if (shouldShow) shown++;
            });

            console.log('Events shown:', shown);

            // Show empty state if no events
            showEmptyState(tabType, shown);
        }

        function showEmptyState(tabType, count) {
            let empty = document.getElementById('tab-empty-state');

            if (count === 0) {
                if (!empty) {
                    empty = document.createElement('div');
                    empty.id = 'tab-empty-state';
                    empty.className = 'empty-state';
                }

                let emptyMessage = '';
                let emptyIcon = 'fa-calendar-times-o';

                if (tabType === 'my-events') {
                    emptyMessage = '<h4>No Events Created</h4><p>You haven\'t created any events yet. Click "Create Event" to get started!</p>';
                    emptyIcon = 'fa-star-o';
                } else if (tabType === 'joined-events') {
                    emptyMessage = '<h4>No Joined Events</h4><p>You haven\'t joined any events yet. Browse all events and join one!</p>';
                    emptyIcon = 'fa-calendar-check-o';
                } else {
                    emptyMessage = '<h4>No Events Available</h4><p>There are no events at the moment. Check back later!</p>';
                }

                empty.innerHTML = `<i class="fa ${emptyIcon}"></i>${emptyMessage}`;
                document.getElementById('event-list').appendChild(empty);
            } else if (empty) {
                empty.remove();
            }
        }

        async function notifySubscribers(eventId, eventData) {
            try {
                const subscribersRef = collection(db, 'newsletter_subscribers')
                const q = query(subscribersRef, where('active', '==', true))
                const snapshot = await getDocs(q)
                if (snapshot.empty) {
                    console.log('no subscriber to notify')
                    return
                }
                console.log(`sending notifications to ${snapshot.size} subscribers...`)

                const formatDateForEmail = (dateString) => {
                    if (!dateString) return 'TBA'
                    const date = new Date(dateString)
                    return date.toLocaleString('en-SG', {
                        day: '2-digit',
                        month: 'long',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: true
                    })
                }
                const batchSize = 5
                const subscribers = []
                snapshot.forEach(doc => subscribers.push(doc.data()))

                for (let i = 0; i < subscribers.length; i += batchSize) {
                    const batch = subscribers.slice(i, i + batchSize);

                    const emailPromises = batch.map(subscriber =>
                        emailjs.send('service_qxa591g', 'template_new_event', {
                            to_email: subscriber.email,
                            event_name: eventData.name,
                            event_description: eventData.description || 'No description provided',
                            event_location: eventData.location,
                            event_category: eventData.category,
                            event_qualifications: eventData.qualifications || 'None specified',
                            event_points: eventData.rewardPoints,
                            event_start: formatDateForEmail(eventData.startDatetime),
                            event_end: formatDateForEmail(eventData.endDatetime),
                            event_link: `${window.location.origin}/homePage/events.html?eventId=${eventId}`
                        }).catch(error => {
                            console.error(`Failed to send to ${subscriber.email}:`, error);
                        })
                    );

                    await Promise.allSettled(emailPromises);
                    if (i + batchSize < subscribers.length) {
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }
                }
                console.log('All notifications sent')
            }
            catch (error) {
                console.error('Error notifying subscribers', error)
            }


        }

        window.joinEvent = async (eventId, eventName, rewardPoints) => {
            try {
                // await addDoc(collection(db, "participations"), {
                // let userId = currentUser.uid
                // let userFullName = currentUser.fullname;
                // let userEmail = currentUser.email;
                // let userSkills = currentUser.skills
                // const profileRef = collection(db, "profiles")
                // const q = query(profileRef, where("userId", "==", userId))
                // const querySnapshot = await getDocs(q)
                // querySnapshot.forEach((doc) => {
                //     console.log(`${doc.id} =>`, doc.data())
                // })

                let profileID = localStorage.getItem('profileID')
                console.log(profileID)
                const eventRef = await doc(db, "events", eventId);
                const eventData = await getDoc(eventRef);

                let newHelpers = eventData.data().helpers;
                let manpower = eventData.data().manpower;
                if (newHelpers.includes(profileID)) {
                    await showCustomAlert("You already requested to join the event!", 'warning', 'Already Joined');
                }
                else if (newHelpers.length >= manpower) {
                    console.log('No more people needed.')
                    await showCustomAlert('Sorry, enough people have signed up for this event', 'warning', 'Event Full');
                }
                else {
                    newHelpers.push(profileID)
                    //record in profiles joinedEvents
                    const profileRef = await doc(db, "profiles", profileID);
                    const profileSnap = await getDoc(profileRef);
                    let newJoinedEvents = profileSnap.data().joinedEvents;
                    newJoinedEvents.push(eventId);
                    await updateDoc(profileRef, {
                        joinedEvents: newJoinedEvents
                    });
                    //record in events helpers
                    await updateDoc(eventRef, {
                        helpers: newHelpers
                    });
                    await showCustomAlert("You have successfully joined to help the event!", 'success', 'Success!');
                    // Reload events to update the tabs
                    loadEvents();
                }
            }
            catch (err) {
                console.error("Join error:", err);
                await showCustomAlert("Failed to join event. Please try again.", 'error', 'Error');
            }
        };

        window.leaveEvent = async (eventId, eventName) => {
            const confirmed = await showCustomConfirm(
                `Are you sure you want to leave "${eventName}"? You can always join again later.`,
                'Leave Event'
            );

            if (!confirmed) return;

            try {
                let profileID = localStorage.getItem('profileID');
                console.log('Leaving event:', eventId, 'Profile:', profileID);

                // Get event reference and data
                const eventRef = doc(db, "events", eventId);
                const eventSnap = await getDoc(eventRef);

                if (!eventSnap.exists()) {
                    await showCustomAlert("Event not found.", 'error', 'Error');
                    return;
                }

                const eventData = eventSnap.data();
                let helpers = eventData.helpers || [];

                // Remove user from event helpers
                helpers = helpers.filter(id => id !== profileID);

                // Update event document
                await updateDoc(eventRef, {
                    helpers: helpers
                });

                console.log('Removed from event helpers');

                // Get profile reference and data
                const profileRef = doc(db, "profiles", profileID);
                const profileSnap = await getDoc(profileRef);

                if (profileSnap.exists()) {
                    let joinedEvents = profileSnap.data().joinedEvents || [];

                    // Remove event from user's joined events
                    joinedEvents = joinedEvents.filter(id => id !== eventId);

                    // Update profile document
                    await updateDoc(profileRef, {
                        joinedEvents: joinedEvents
                    });

                    console.log('Removed from profile joinedEvents');
                }

                await showCustomAlert(`You have successfully left "${eventName}".`, 'success', 'Left Event');

                // Reload events to update the UI and tabs
                loadEvents();
            }
            catch (err) {
                console.error("Leave event error:", err);
                await showCustomAlert("Failed to leave event. Please try again.", 'error', 'Error');
            }
        };

        window.deleteEvent = async (eventId, eventName) => {
            const confirmed = await showCustomConfirm(`Are you sure you want to delete "${eventName}"?`, 'Delete Event');
            if (!confirmed) return;
            try {
                await deleteDoc(doc(db, "events", eventId));
                loadEvents();
                await showCustomAlert(`"${eventName}" has been deleted successfully.`, 'success', 'Event Deleted');
            } catch (err) {
                console.error(err);
                await showCustomAlert("Failed to delete event. Please try again.", 'error', 'Error');
            }
        };

        window.editEvent = (eventId) => {
            window.location.href = `../eventCreation/eventEdit.html?eventId=${eventId}`;
        };

        window.viewapplicants = (eventId) => {
            window.location.href = `../eventCreation/reviewApplicants.html?eventId=${eventId}`;
        };

        window.endEvent = async (eventId, eventName) => {
            const confirmed = await showCustomConfirm(`Are you sure you want to end "${eventName}"? This will award points to all helpers.`, 'End Event');
            if (!confirmed) return;
            try {
                const eventRef = doc(db, "events", eventId);
                const eventSnap = await getDoc(eventRef);
                if (!eventSnap.exists()) {
                    await showCustomAlert("Event not found.", 'error', 'Error');
                    return;
                }
                const eventData = eventSnap.data();
                console.log(eventData);
                const helpers = eventData.helpers || [];
                const reward = eventData.rewardPoints || 0;
                await addDoc(collection(db, "complete_events"), {
                    ...eventData,
                    endedAt: serverTimestamp()
                });
                console.log(helpers);
                for (const helperId of helpers) {
                    const profileRef = doc(db, "profiles", helperId);
                    const profileSnap = await getDoc(profileRef);

                    if (profileSnap.exists()) {
                        const currentPoints = profileSnap.data().points || 0;
                        await updateDoc(profileRef, {
                            points: currentPoints + reward,
                        });
                    } else {
                        console.warn(`Profile not found for helper: ${helperId}`);
                    }
                }
                await deleteDoc(doc(db, "events", eventId));
                await showCustomAlert(`"${eventName}" has ended successfully! ${reward} points awarded to ${helpers.length} helper(s).`, 'success', 'Event Ended');
                loadEvents();
            } catch (err) {
                console.error(err);
                await showCustomAlert("Failed to end event. Please try again.", 'error', 'Error');
            }
        };

        onAuthStateChanged(auth, (user) => {
            currentUser = user;

            loadEvents();
        });

        emailjs.init("VKk3x4Hb19VUPRuAh");

        // Newsletter Subscription Handler
        document.getElementById('newsletter-form').addEventListener('submit', async function (event) {
            event.preventDefault();

            const btn = this.querySelector('button[type="submit"]');
            const responseDiv = document.getElementById('newsletter-response');
            const originalBtnHtml = btn.innerHTML;
            const emailInput = this.querySelector('input[name="to_email"]');
            const email = emailInput.value.trim();

            btn.disabled = true;
            btn.innerHTML = 'Processing...';
            responseDiv.innerHTML = '';

            try {
                console.log('📝 Attempting to subscribe:', email);

                // Check if email already exists
                const subscribersRef = collection(db, "newsletter_subscribers");
                const q = query(subscribersRef, where("email", "==", email));
                const querySnapshot = await getDocs(q);

                if (!querySnapshot.empty) {
                    console.log('⚠️ Email already subscribed');
                    responseDiv.innerHTML = '<p style="color: #ff9800; margin-top: 10px;">⚠ You are already subscribed!</p>';
                    btn.disabled = false;
                    btn.innerHTML = originalBtnHtml;
                    setTimeout(() => { responseDiv.innerHTML = ''; }, 5000);
                    return;
                }

                // Save to Firestore
                await addDoc(subscribersRef, {
                    email: email,
                    subscribedAt: serverTimestamp(),
                    active: true
                });

                console.log('✅ Subscriber saved to Firestore:', email);

                // Send welcome email
                await emailjs.sendForm('service_qxa591g', 'template_4ql5kl9', this);

                console.log('✅ Welcome email sent to:', email);

                responseDiv.innerHTML = '<p style="color: #4CAF50; margin-top: 10px;">✓ Successfully subscribed! Check your email.</p>';
                this.reset();

                setTimeout(function () {
                    btn.disabled = false;
                    btn.innerHTML = originalBtnHtml;
                    responseDiv.innerHTML = '';
                }, 5000);

            } catch (error) {
                console.error('❌ Newsletter subscription error:', error);
                responseDiv.innerHTML = '<p style="color: #f44336; margin-top: 10px;">✗ Failed to subscribe. Please try again.</p>';
                btn.disabled = false;
                btn.innerHTML = originalBtnHtml;
            }
        });

        async function loadTopRatedFeedback() {
            const topContainer = document.getElementById('topRatedEvents');

            if (!topContainer) {
                console.error("Element with id 'topRatedEvents' not found!");
                return;
            }

            topContainer.innerHTML = '<p>Loading...</p>';

            const feedbackRef = collection(db, "feedback");
            const q = query(feedbackRef, orderBy("rating", "desc"), limit(3));

            try {
                const snapshot = await getDocs(q);

                if (snapshot.empty) {
                    topContainer.innerHTML = "<p>No top rated feedback found.</p>";
                    return;
                }

                topContainer.innerHTML = ''; // Clear loading message

                snapshot.forEach(doc => {
                    const data = doc.data();

                    // Create card using correct fields from feedback documents
                    const card = document.createElement('div');
                    card.classList.add('single-rated');
                    card.innerHTML = `
        <h4>${data.eventName || 'Unknown Event'}</h4>
        <h5>Rating: ${data.rating || 0} ★</h5>
        <p>${data.feedback || ''}</p>
        <p><strong>By:</strong> ${data.helperName || 'Anonymous'}</p>
      `;

                    topContainer.appendChild(card);
                });
            } catch (err) {
                console.error("Error loading feedback:", err);
                topContainer.innerHTML = `<p>Error loading feedback: ${err.message}</p>`;
            }
        }

        window.addEventListener('load', () => {
            console.log("Page loaded, calling loadTopRatedFeedback");
            loadTopRatedFeedback();
        });


    </script>
</body>

</html>