<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
	<!-- Mobile Specific Meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon-->
	<link rel="shortcut icon" href="img/fav.png">
	<!-- Author Meta -->
	<meta name="author" content="codepixer">
	<!-- Meta Description -->
	<meta name="description" content="">
	<!-- Meta Keyword -->
	<meta name="keywords" content="">
	<!-- meta character set -->
	<meta charset="UTF-8">
	<!-- Site Title -->
	<title>Smuuth Events</title>

	<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700" rel="stylesheet">
	<!--
			CSS
			============================================= -->
	<link rel="stylesheet" href="css/linearicons.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/magnific-popup.css">
	<link rel="stylesheet" href="css/nice-select.css">
	<link rel="stylesheet" href="css/animate.min.css">
	<link rel="stylesheet" href="css/owl.carousel.css">
	<link rel="stylesheet" href="css/main.css">

</head>

<body>

	<header id="header" id="home">
		<div class="container">
			<div class="row align-items-center justify-content-between d-flex">
				<div id="logo">
					<a href="index.html"><img src="img/SMUUTH_words_pastel_ultraclean.png" alt="SMUUTH"
							style="height:48px;width:auto;display:block"></a>
				</div>
				<nav id="nav-menu-container">
					<ul class="nav-menu">
						<li class="menu-active"><a href="index.html">Home</a></li>
						<li><a href="about-us.html">About Us</a></li>
						<li><a href="events.html">Events</a></li>
						<li><a href="calendar.html">Calendar</a></li>
						<li><a href="points.html">Points</a></li>
						<li><a class="ticker-btn" href="reviews.html">Feedback Form</a></li>
						<li>
							<a href="../loginPage_file/ViewProfile.html" class="profile-icon-btn" aria-label="Profile">
								<i class="fa fa-user"></i>
							</a>
						</li>
					</ul>
				</nav><!-- #nav-menu-container -->
			</div>
		</div>
	</header><!-- #header -->

	<!-- start banner Area -->
	<section class="banner-area relative" id="home">
		<div class="overlay overlay-bg"></div>
		<div class="container">
			<div class="row d-flex align-items-center justify-content-center">
				<div class="about-content col-lg-12">
					<h1 class="text-white" id="points">
						Points Page
					</h1>
					<!-- <p class="text-white link-nav"><a href="index.html">Home </a>  <span class="lnr lnr-arrow-right"></span>  <a href="blog-home.html"> Blog Posts</a></p> -->
				</div>
			</div>
		</div>
	</section>
	<!-- End banner Area -->

	<!-- Start blog-posts Area -->
	<section class="post-area section-gap">
		<div class="container">
			<div class="row justify-content-center d-flex" id="rewardArea">
				<!-- <div class="col-lg-4 post-list" id="rewardArea">
					 Reward cards go here 
				</div> -->
			</div>
			<div class="row justify-content-center d-flex" id="manageArea">
			</div>
		</div>
	</section>

	<!-- End blog-posts Area -->

	<!-- start footer Area -->
	<footer class="footer-area section-gap">
  <div class="container">
    <div class="row">
      <div class="col-lg-6 col-md-12">
        <div class="single-footer-widget newsletter">
          <h6>Newsletter</h6>
          <p>You can trust us. We only send promo offers, not a single spam.</p>

          <form id="newsletter-form">
            <div class="form-group row" style="width: 100%">
              <div class="col-lg-8 col-md-12">
                <input
                  name="to_email"
                  placeholder="Enter Email"
                  onfocus="this.placeholder=''"
                  onblur="this.placeholder='Enter Email'"
                  required
                  type="email"
                />
              </div>

              <div class="col-lg-4 col-md-12">
                <button type="submit" class="nw-btn primary-btn">
                  Subscribe<span class="lnr lnr-arrow-right"></span>
                </button>
              </div>
            </div>

            <div class="info" id="newsletter-response"></div>
          </form>
        </div>
      </div>
    </div>

    <div class="row footer-bottom d-flex justify-content-between">
      <p class="col-lg-8 col-sm-12 footer-text m-0 text-white">
        Copyright &copy;
        <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is
        made with <i class="fa fa-heart-o" aria-hidden="true"></i> by
        <a href="https://colorlib.com" target="_blank">Colorlib</a>
      </p>
      <div class="col-lg-4 col-sm-12 footer-social">
        <a href="#"><i class="fa fa-facebook"></i></a>
        <a href="#"><img src="img/tiktok logo.png.svg" alt="tiktok logo"></a>
        <a href="https://www.instagram.com/smuuthevents?igsh=ZTJ2OWs2MHB2OW94&utm_source=qr"><i class="fa fa-instagram"></i></a>
      </div>
    </div>
  </div>
</footer>

<!-- EmailJS v4 (load once, below your other scripts) -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  (function () {
    emailjs.init("VKk3x4Hb19VUPRuAh"); // Replace with your EmailJS public key
  })();

  document.getElementById('newsletter-form').addEventListener('submit', function (event) {
    event.preventDefault();

    const btn = this.querySelector('button[type="submit"]');
    const responseDiv = document.getElementById('newsletter-response');
    const originalBtnHtml = btn.innerHTML;

    // Disable button and show loading
    btn.disabled = true;
    btn.innerHTML = 'Sending...';
    responseDiv.innerHTML = '';

    // Send email using EmailJS
    emailjs.sendForm('service_qxa591g', 'template_4ql5kl9', this)
      .then(function (response) {
        console.log('Newsletter subscription successful!', response.status, response.text);
        responseDiv.innerHTML = '<p style="color: #4CAF50; margin-top: 10px;">✓ Successfully subscribed!</p>';
        document.getElementById('newsletter-form').reset();

        setTimeout(function () {
          btn.disabled = false;
          btn.innerHTML = originalBtnHtml;
          responseDiv.innerHTML = '';
        }, 3000);
      }, function (error) {
        console.log('Newsletter subscription failed:', error);
        responseDiv.innerHTML = '<p style="color: #f44336; margin-top: 10px;">✗ Failed to subscribe. Please try again.</p>';

        btn.disabled = false;
        btn.innerHTML = originalBtnHtml;
      });
  });
</script>
	<!-- End footer Area -->

	<script src="js/vendor/jquery-2.2.4.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	<script src="js/vendor/bootstrap.min.js"></script>
	<script type="text/javascript"
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhOdIF3Y9382fqJYt5I_sswSrEw5eihAA"></script>
	<script src="js/easing.min.js"></script>
	<script src="js/hoverIntent.js"></script>
	<script src="js/superfish.min.js"></script>
	<script src="js/jquery.ajaxchimp.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.sticky.js"></script>
	<script src="js/jquery.nice-select.min.js"></script>
	<script src="js/parallax.min.js"></script>
	<script src="js/mail-script.js"></script>
	<script src="js/main.js"></script>

	<script type="module">
		// check if login
		import { checkLogin } from "../loginPage_file/authenticate.js";

		checkLogin()

		import { getPoints } from '../points/points.js'
		// getting the profileid
		let profileID = localStorage.getItem('profileID');
		// console.log(profileID);
		//populating the points
		let h1 = document.getElementById("points")
		let points = await getPoints(profileID)
		if (points != null) {
			h1.innerText = "Your Points: " + points
		}

		import { getAllRewards, redeemReward, getRole } from '../reward/reward.js'
		let row = document.getElementById('rewardArea')
		let rewardList = await getAllRewards();
		let role = await getRole(profileID);

		// iterate through the reward list and populate the screen
		for (let reward of rewardList) {
			// <div class="single-post d-flex flex-row">
			// Card (add job-listing, remove border)
			let col = document.createElement("div");
			col.setAttribute('class', 'col-lg-4 post-list');// size
			row.appendChild(col);

			const card = document.createElement('div');
			card.className = 'single-post d-flex flex-row';
			col.appendChild(card);

			const thumb = document.createElement('div')
			thumb.className = 'thumb'
			const img = document.createElement('img')
			img.className = 'img-fluid w-50'
			img.src = './img/lilykong.jpg'
			img.alt = ''
			thumb.appendChild(img)
			card.appendChild(thumb)

			// Details
			const details = document.createElement('div');
			details.className = 'details';
			card.appendChild(details);

			// Title row
			const titleDiv = document.createElement('div');
			titleDiv.className = 'title d-flex flex-row justify-content-between';
			details.appendChild(titleDiv);

			// Left: titles
			const titlesDiv = document.createElement('div');
			titlesDiv.className = 'titles';
			titleDiv.appendChild(titlesDiv);

			const a = document.createElement('a');
			a.href = '#';
			const h4 = document.createElement('h4');
			h4.textContent = reward.data.rewardName;
			a.appendChild(h4);
			titlesDiv.appendChild(a);

			// (no subtitle since you removed it)

			// Right: actions
			const btns = document.createElement('ul');
			btns.className = 'btns';

			// optional heart (keeps spacing like index)


			// Redeem MUST be the last li so theme applies the primary style
			const liRedeem = document.createElement('li');
			const aRedeem = document.createElement('a');
			aRedeem.href = '#';
			aRedeem.textContent = 'Redeem';
			aRedeem.addEventListener('click', (e) => {
				e.preventDefault();
				redeemReward(reward.id, profileID);
			});
			liRedeem.appendChild(aRedeem);
			btns.appendChild(liRedeem);
			titleDiv.appendChild(btns);

			// Body/meta (optional) //???
			// const h5 = document.createElement('h5');
			// h5.textContent = reward.data.type ? `Reward Type: ${reward.data.type}` : 'Reward';
			// details.appendChild(h5);

			const pointsLine = document.createElement('p');
			pointsLine.className = 'address';
			pointsLine.innerHTML = `<span class="lnr lnr-database"></span> Points required: ${reward.data.pointsAmount}`;
			details.appendChild(pointsLine);

			// if (reward.data.location) {
			// 	const loc = document.createElement('p');
			// 	loc.className = 'address';
			// 	loc.innerHTML = `<span class="lnr lnr-map"></span> ${reward.data.location}`;
			// 	details.appendChild(loc);
			// }
		}

		if (role == 'systemAdmin') {
			let button = document.createElement("button")
			button.setAttribute("class", "btn btn-danger")
			button.innerText = "Manage Reward"
			let area = document.getElementById("manageArea");
			area.appendChild(button)

			button.addEventListener('click', () => {
				window.location.replace('manageReward.html');
			})
		}
	</script>
</body>

</html>
