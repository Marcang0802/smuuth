  <!DOCTYPE html>
  <html lang="en">
    
  <head>
    
    <meta charset="UTF-8" />
    <title>Create Event | SMU Event Helpers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
      body {
        background: linear-gradient(135deg, #d6e4ff, #f8f9fa); min-height: 100vh; display: flex; justify-content: center; align-items: center; font-family: "Poppins", sans-serif; 
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        color: white;
        background-image: url("../homePage/img/blog2.jpg");
        background-size: cover;          
        background-position: center;    
        background-repeat: no-repeat;
      }
      .card {
        max-width: 450px; border-radius: 20px; box-shadow: 0 6px 25px rgba(0,0,0,0.1); background-color: rgba(0, 0, 0, 0.7); overflow: hidden;
      }
      .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.12);
      }
      .card-header {
        background: #004aad;
        color: #fff;
        text-align: center;
        padding: 1.5rem;
      }
      .form-label {
        font-weight: 500;
        color: #333;
      }
      .btn-success {
        background-color: #28a745;
        border: none;
        font-weight: 600;
        transition: background-color 0.3s ease-in-out;
      }
      .btn-success:hover {
        background-color: #218838;
      }
      input, textarea {
        border-radius: 10px !important;
      }
      .form-control:focus {
        border-color: #004aad;
        box-shadow: 0 0 0 0.2rem rgba(0,74,173,0.25);
      }
      footer {
        text-align: center;
        margin-top: 30px;
        font-size: 0.9rem;
        color: #666;
      }
      #event{color: white; text-align: center; padding: 1.5rem;}
      .form-label{color: white;}
      .btn { border-radius: 50px; font-weight: 600; margin: 6px 0; background-color: #007bff;; border: none; font-weight: 600; }
      .btn:hover { background-color: rgb(41, 41, 255); }
    </style>
  </head>

  <body>
    <div class="card">
      <h2 id="event" class="bi bi-calendar-event me-2">Create Event</h2>
      <div class="card-body p-4">
        <form id="eventForm">
          <div class="mb-3">
            <label for="eventName" class="form-label">Name of Event</label>
            <input type="text" class="form-control" id="eventName" name="eventName" required placeholder="E.g. SMU Open House 2025" />
          </div>

          <div class="mb-3">
            <label for="category" class="form-label">Category</label>
            <select id="category" name="category" class="form-control" required>
              <option value="">-- Select a category --</option>
              <option>Clubs</option>
              <option>Performing Arts</option>
              <option>Sports</option>
              <option>Community Service</option>
              <option>Academic</option>
              <option>Others</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="eventLocation" class="form-label">Location</label>
            <input type="text" class="form-control" id="eventLocation" name="eventLocation" required placeholder="E.g. Campus Green" />
          </div>

          <div class="mb-3">
            <label for="eventDescription" class="form-label">Event Description</label>
            <textarea class="form-control" id="eventDescription" name="eventDescription" rows="3" placeholder="Describe the event..."></textarea>
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="manpower" class="form-label">Manpower Needed</label>
              <input type="number" class="form-control" id="manpower" name="manpower" min="1" required placeholder="E.g. 10" />
            </div>
            <div class="col-md-6 mb-3">
              <label for="rewardPoints" class="form-label">Reward Points</label>
              <input type="number" class="form-control" id="rewardPoints" name="rewardPoints" min="0" value="50" />
            </div>
          </div>

          <div class="mb-3">
            <label for="qualifications" class="form-label">Specific Qualifications Needed</label>
            <input type="text" class="form-control" id="qualifications" name="qualifications" placeholder="E.g. First Aid, Crowd Control" />
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="startDatetime" class="form-label">Start Date & Time</label>
              <input type="datetime-local" class="form-control" id="startDatetime" name="startDatetime" required />
            </div>
            <div class="col-md-6 mb-3">
              <label for="endDatetime" class="form-label">End Date & Time</label>
              <input type="datetime-local" class="form-control" id="endDatetime" name="endDatetime" required />
            </div>
          </div>

          <button type="submit" class="btn btn-success w-100 py-2 mt-2">
            <i class="bi bi-plus-circle me-2"></i>Create Event
          </button>
        </form>
      </div>
    </div>

    <!-- Firebase & Firestore integration -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyByPrDz810_ttwZz0BdAJkeP54rMIqH3uw",
        authDomain: "wad2-505be.firebaseapp.com",
        databaseURL: "https://wad2-505be-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "wad2-505be",
        storageBucket: "wad2-505be.firebasestorage.app",
        messagingSenderId: "221863917439",
        appId: "1:221863917439:web:2a517ca11c83e991388c4a",
        measurementId: "G-L69GG585GF"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const auth = getAuth(app);

      let user = null;

    onAuthStateChanged(auth, (u) => {
      if (u) {
        user = u;

        const form = document.getElementById("eventForm");
        form.addEventListener("submit", async (e) => {
          e.preventDefault();

          const data = {
            name: document.getElementById("eventName").value.trim(),
            location: document.getElementById("eventLocation").value.trim(),
            description: document.getElementById("eventDescription").value.trim(),
            manpower: parseInt(document.getElementById("manpower").value),
            qualifications: document.getElementById("qualifications").value.trim(),
            startDatetime: document.getElementById("startDatetime").value,
            endDatetime: document.getElementById("endDatetime").value,
            rewardPoints: parseInt(document.getElementById("rewardPoints").value),
            creatorId: user.uid,
            creatorEmail: user.email,
            createdAt: serverTimestamp(),
            pending: [],
            helpers: [],
            rejected: []
          };

          try {
            await addDoc(collection(db, "events"), data);
            window.location.href = "../homePage/events.html";
          } catch (error) {
            console.error("Error creating event:", error);
            alert("Failed to create event. Check console for details.");
          }
        });

      } else {
        alert("You must be logged in to create events!");
        window.location.href = "../loginPage_file/login.html";
      }
    });
    </script>
  </body>
  </html>

