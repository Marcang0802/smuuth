<!-- 
<div class="card p-3">
    <div class="row g-3 align-items-start">
        <div class="col-auto text-center">
            <img style="width: 200px; height: 200px;" src="../homePage/img/profile.png" alt="">
            <button class="btn btn-primary">Edit Profile</button>
        </div>
        <div class="container">
            <h4><p>Name: </p></h4>
            <p>Phone Number: </p>
            <p>Qualifications: 
                <ul>
                    <li></li>
                    <li></li>
                    <li></li>       
                </ul>
            </p>
        </div>

    </div>
</div>
<style>
    .card {
  /* Add shadows to create the "card" effect */
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  display: flex;
}

/* On mouse-over, add a deeper shadow */
.card:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
}

/* Add some padding inside the card container */
.container {
  padding: 2px 16px;
}
.d-flex{
    display: flex;
}
</style> -->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Profile | SMU Event Helpers</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background: linear-gradient(135deg, #d6e4ff, #f8f9fa); min-height: 100vh; display: flex; justify-content: center; align-items: center; font-family: "Poppins", sans-serif; }
    .card { max-width: 450px; border-radius: 20px; box-shadow: 0 6px 25px rgba(0,0,0,0.1); background-color: #fff; overflow: hidden; }
    .card-header { background: #004aad; color: #fff; text-align: center; padding: 1.5rem; }
    .profile-pic { width: 110px; height: 110px; border-radius: 50%; object-fit: cover; border: 4px solid #faf9ff; background: #e7e7f7; margin: auto; display: block; }
    .info-header { font-weight: 600; font-size: 1.1rem; color: #333; margin-top: 15px; }
    .info-value { font-size: 1rem; color: #555; }
    .btn { border-radius: 50px; font-weight: 600; margin: 6px 0; }
  </style>
</head>
<body>
  <div class="card">
    <div class="card-header">
      <h2 class="mb-0">Your Profile</h2>
    </div>
    <div class="card-body p-4 text-center">
      <img id="profilePic" src="../loginPage_file/default-avatar.png" alt="Profile Picture" class="profile-pic mb-3" />
      <div class="info-header">Name:</div>
      <div id="userName" class="info-value mb-2"></div>
      <div class="info-header">Phone Number:</div>
      <div id="userPhone" class="info-value mb-2"></div>
      <div class="info-header">Role:</div>
      <div id="userRole" class="info-value mb-2"></div>
      <div class="info-header">Qualifications/Skills:</div>
      <div id="userSkills" class="info-value mb-3"></div>
      <button class="btn btn-primary w-75" id="editBtn">Edit Profile</button>
      <button class="btn btn-secondary w-75" id="backBtn">Back to Home</button>
    </div>
      <div class="profile-pic-container mb-3" id="profilePicContainer">
        <img id="profilePic" src="../loginPage_file/default-avatar.png" alt="Profile Picture" class="profile-pic" />
        <div class="upload-overlay">
          <span>ðŸ“· Upload Photo</span>
        </div>
      </div>
      <input type="file" id="fileInput" accept="image/*" />
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyByPrDz810_ttwZz0BdAJkeP54rMIqH3uw",
      authDomain: "wad2-505be.firebaseapp.com",
      databaseURL: "https://wad2-505be-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "wad2-505be",
      storageBucket: "wad2-505be.firebasestorage.app",
      messagingSenderId: "221863917439",
      appId: "1:221863917439:web:2a517ca11c83e991388c4a",
      measurementId: "G-L69GG585GF"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        alert("You must be logged in to view your profile!");
        window.location.href = "../loginPage_file/login.html";
        return;
      }
      // Query the profile data based on Auth UID
      const profilesRef = collection(db, "profiles");
      const q = query(profilesRef, where("userId", "==", user.uid));
      const snap = await getDocs(q);

      if (snap.empty) {
        alert("Profile not found. Please create your profile.");
        window.location.href = "../loginPage_file/profile.html";
        return;
      }
      // Support only single profile per account for this example
      const doc = snap.docs[0].data();
      document.getElementById("userName").textContent = doc.fullname || "";
      document.getElementById("userPhone").textContent = doc.phone || "";
      document.getElementById("userRole").textContent = doc.role || "";
      document.getElementById("userSkills").textContent = Array.isArray(doc.skills) ? doc.skills.join(", ") : doc.skills || "";

      // Optionally use doc.photoUrl if you allow uploading profile pictures
      // Otherwise keep default avatar
      if (doc.photoUrl) {
        document.getElementById("profilePic").src = doc.photoUrl;
      }
    });

    document.getElementById("editBtn").onclick = () => {
      window.location.href = "../loginPage_file/editProfile.html";
    };
    document.getElementById("backBtn").onclick = () => {
      window.location.href = "../homePage/events.html";
    };
  </script>
</body>
</html>
